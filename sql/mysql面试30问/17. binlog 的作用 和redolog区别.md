# binlog

- 是一个二进制格式的文件，用来记录数据库更新的sql语句。
- 是在mysql的server层实现的，是所有引擎公用的
- 是逻辑体制，记录的是一条sql语句的原始逻辑
- 不限制大小，不会覆盖之前的日志

# binlog的使用场景

1. 主从赋值

   把主库的binlog发给从库，保证主从数据的一致性

2. 数据恢复

   通过mysql binlog工具来恢复数据

# binlog3中模式

1. row模式：日志记录每一行数据被修改的情况，然后对从库对相同的数据进行修改
   - 优点：能清楚记录每一行数据的修改细节，能完全实现主从同步和数据同步
   - 缺点：批量操作，会产生大量的日志，导致日志增长过快
2. Statment模式：记录每一天修改数据的sql（如果是批量修改，记录的不是单条sql而是批量修改的sql事件）
   - 优点：日志量比较小，提升存储恢复的速度
   - 缺点：在某些情况下会导致主从不一致（比如你用了时间函数）
3. 混合模式：一般情况用statment，无法胜任的选择row模式



# 如何选择3中模式

如果生产中mysql的特殊功能比较少（存储过程，触发器）选择statment，多了就选择混合模式。如果数据最大化的一致性，用row模式



# binlog 和redolog的区别

1. redo log是inndb存储引擎特有的，binlog是mysql服务层实现的
2. redo是物理日志，记录的是在某某表空间的页的偏移量做了什么修改。binlog是逻辑日志记录的是对应的sql语句
3. redolog是循环写入，会产生覆盖，用write pos和checkpoint搭配只用。binlog是追加写，写到一定大小会切换，不会覆盖之前的，是全量保存的
4. redolog是宕机作为事务数据恢复，binlog作为主从复制数据恢复（==binlog自己无法区分自己这个日志记录的操作是否已经落盘，所以无法作为恢复日志==）
